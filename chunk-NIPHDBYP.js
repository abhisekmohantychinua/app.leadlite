import{a as S,b as ee,c as te,d as ae,f as ne,g as oe,h as re}from"./chunk-6HFM6VA2.js";import{a as K,b as Q}from"./chunk-SZPG4BV7.js";import{a as $}from"./chunk-4TW7DZPH.js";import{c as w,e as V,g as I,j as D,o as M,s as ie}from"./chunk-TV2VNHIC.js";import{a as X,b as Y}from"./chunk-LCPDGZUE.js";import{r as Z}from"./chunk-ZL67F5YZ.js";import{g as W,h as U,o as G,q as J}from"./chunk-DBNTJJ5Q.js";import{$b as A,Db as y,Hb as u,Ib as c,M as E,Na as l,Wb as P,X as m,Xb as d,Za as v,Zb as x,_b as j,aa as f,ac as q,ba as g,db as B,gc as h,ic as O,ja as R,jc as z,kc as H,ob as b,pb as _,tb as s,u as N,ub as a,uc as C,vb as n,wb as p}from"./chunk-QDV7XRN5.js";function pe(t,i){if(t&1&&p(0,"i",2),t&2){let e=i.$implicit;P(e.icon),s("pTooltip",e.tooltip)}}var T=class t{leadService=m(S);updateLeadSubscription;LeadStageOptions=[{icon:"pi pi-inbox",tooltip:"New",value:"new"},{icon:"pi pi-comments",tooltip:"Contacted",value:"contacted"},{icon:"pi pi-file-edit",tooltip:"Proposal",value:"proposal"},{icon:"pi pi-check-circle",tooltip:"Closed",value:"closed"}];leadStage=C.required();leadId=C.required();leadFormControl=new I("new",[w.required]);ngOnInit(){this.leadFormControl.setValue(this.leadStage())}saveStage(){this.leadService.updateLead(this.leadId(),{stage:this.leadFormControl.value}).subscribe({next:()=>{},error:i=>{console.error("Error updating lead stage:",i)}})}ngOnDestroy(){this.updateLeadSubscription?.unsubscribe()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=v({type:t,selectors:[["app-lead-stage"]],inputs:{leadStage:[1,"leadStage"],leadId:[1,"leadId"]},decls:3,vars:2,consts:[["item",""],["name","leadStage","size","small","aria-label","Select Lead Stage",3,"onChange","options","formControl"],["showDelay","800","autoHide","true","tooltipPosition","bottom",3,"pTooltip"]],template:function(e,o){if(e&1){let r=y();a(0,"p-selectbutton",1),u("onChange",function(){return f(r),g(o.saveStage())}),B(1,pe,1,3,"ng-template",null,0,H),n()}e&2&&s("options",o.LeadStageOptions)("formControl",o.leadFormControl)},dependencies:[ae,M,V,D,Y,X],encapsulation:2})};function me(t,i){t&1&&(a(0,"p-message",2),d(1," Value must be zero or higher. "),n())}function ue(t,i){if(t&1){let e=y();a(0,"p-iftalabel")(1,"p-inputnumber",0),u("blur",function(){f(e);let r=c();return g(r.saveValue())})("keydown.enter",function(){f(e);let r=c();return g(r.saveValue())}),n(),a(2,"label",1),d(3,"Value (INR)"),n()(),b(4,me,2,0,"p-message",2)}if(t&2){let e=c();l(),s("formControl",e.leadFormControl)("invalid",e.leadFormControl.invalid),l(3),_(e.leadFormControl.invalid?4:-1)}}function ce(t,i){if(t&1&&(d(0),h(1,"currency")),t&2){let e=c(2);x(" ",z(1,1,e.leadFormControl.value,"INR","symbol","1.0-0")," ")}}function fe(t,i){t&1&&d(0," - ")}function ge(t,i){if(t&1){let e=y();a(0,"p"),p(1,"i",3),a(2,"span",4),u("dblclick",function(){f(e);let r=c();return g(r.toggleEditMode())}),b(3,ce,2,6)(4,fe,1,0),n()()}if(t&2){let e=c();l(3),_(e.leadFormControl.value!==null&&e.leadFormControl.value!==void 0?3:4)}}var F=class t{leadService=m(S);updateLeadSubscription;editMode=R(!1);leadValue=C(void 0);leadId=C.required();leadFormControl=new I(null,[w.min(0)]);ngOnInit(){this.leadFormControl.setValue(this.leadValue()??null)}toggleEditMode(){this.editMode.set(!this.editMode())}saveValue(){if(this.leadFormControl.markAsTouched(),this.leadFormControl.invalid)return;let i=this.leadFormControl.value??void 0;this.updateLeadSubscription?.unsubscribe(),this.updateLeadSubscription=this.leadService.updateLead(this.leadId(),{value:i}).subscribe({next:()=>{this.editMode.set(!1)},error:e=>{console.error("Error updating lead value:",e)}})}ngOnDestroy(){this.updateLeadSubscription?.unsubscribe()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=v({type:t,selectors:[["app-lead-value"]],inputs:{leadValue:[1,"leadValue"],leadId:[1,"leadId"]},decls:2,vars:1,consts:[["inputId","lead-value-input","mode","currency","currency","INR","currencyDisplay","symbol","locale","en-IN",3,"blur","keydown.enter","formControl","invalid"],["for","lead-value-input"],["severity","error","size","small","variant","simple"],[1,"pi","pi-wallet","text-xl","text-primary"],[1,"font-semibold","text-2xl",3,"dblclick"]],template:function(e,o){e&1&&b(0,ue,5,3)(1,ge,5,1,"p"),e&2&&_(o.editMode()?0:1)},dependencies:[M,V,D,te,ee,oe,ne,ie,U],encapsulation:2,changeDetection:0})};function ve(t,i){if(t&1&&(a(0,"div",1),p(1,"app-lead-title",2),n(),a(2,"div",3),p(3,"app-lead-value",4),n(),a(4,"div",5),p(5,"app-lead-stage",6),n(),a(6,"div",7)(7,"p",8),d(8," Activity "),n(),a(9,"div",9)(10,"div",10)(11,"span",11),d(12,"Created"),n(),a(13,"span",12),d(14),h(15,"date"),n()(),a(16,"div",13)(17,"span",11),d(18,"Updated"),n(),a(19,"span",12),d(20),h(21,"date"),n()()()(),p(22,"p-divider",14)),t&2){let e=i;l(),s("leadId",e.getId())("leadTitle",e.getTitle()),l(2),s("leadId",e.getId())("leadValue",e.getValue()),l(2),s("leadId",e.getId())("leadStage",e.getStage()),l(9),x(" ",O(15,8,e.getCreatedAt(),"MMM dd, yyyy 'at' hh:mm a")," "),l(6),x(" ",O(21,11,e.getLastModifiedAt(),"MMM dd, yyyy 'at' hh:mm a")||"-"," ")}}var k=class t{router=m(J);activatedRoute=m(G);leadService=m(S);lead=Z(this.activatedRoute.params.pipe(N(i=>i.id),E(i=>this.leadService.getLeadById(i))));drawerVisible=!1;ngOnInit(){this.drawerVisible=!0}navigateBackOnClose(){this.router.navigate(["leads"])}ngOnDestroy(){this.drawerVisible=!1}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=v({type:t,selectors:[["app-lead-detail"]],decls:2,vars:2,consts:[["header","Lead Details","position","right",3,"onHide","visibleChange","visible"],[1,"w-full","mb-4"],[3,"leadId","leadTitle"],[1,"w-full","text-start","mb-4"],[3,"leadId","leadValue"],[1,"w-full","text-end","mb-4"],[3,"leadId","leadStage"],[1,"w-full","rounded-2xl","border","border-slate-200/70","px-4","py-4","text-xs","shadow-sm","shadow-slate-200/60","ring-1","ring-white/70","backdrop-blur","dark:border-slate-700/70","dark:shadow-slate-950/60","dark:ring-white/10","mt-4"],[1,"mb-3","text-[0.65rem]","uppercase","tracking-[0.2em]","text-slate-500","dark:text-slate-400"],[1,"flex","flex-col","divide-y","divide-slate-200/60","dark:divide-slate-700/60"],[1,"flex","items-center","justify-between","gap-4","py-2","first:pt-0"],[1,"text-[0.65rem]","uppercase","tracking-[0.12em]","text-slate-500","dark:text-slate-400"],[1,"font-semibold","text-slate-600","dark:text-slate-50"],[1,"flex","items-center","justify-between","gap-4","py-2"],[1,"w-full"]],template:function(e,o){if(e&1&&(a(0,"p-drawer",0),u("onHide",function(){return o.navigateBackOnClose()}),q("visibleChange",function(L){return A(o.drawerVisible,L)||(o.drawerVisible=L),L}),b(1,ve,23,14),n()),e&2){let r;j("visible",o.drawerVisible),l(),_((r=o.lead())?1:-1,r)}},dependencies:[Q,K,re,T,F,$,W],encapsulation:2})};export{k as default};
