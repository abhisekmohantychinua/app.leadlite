<section class="profile-shell">
    <p-button
      type="button"
      severity="secondary"
      rounded
      size="small"
      variant="outlined"
      styleClass="profile-shell__trigger p-1"
      [attr.aria-label]="triggerLabelSig()"
      aria-haspopup="dialog"
      [attr.aria-expanded]="sidebarVisible()"
      [disabled]="!!errorSig()"
      (click)="openSidebar()">
      @if (avatarSrcSig()) {
        <p-avatar
          shape="circle"
          size="normal"
          [image]="avatarSrcSig()!"
          aria-hidden="true"
          ></p-avatar>
      } @else {
        <p-avatar
          shape="circle"
          size="large"
          [label]="initialsSig()"
          aria-hidden="true"
          ></p-avatar>
      }
    </p-button>

    @if (errorSig()) {
      <p class="profile-shell__error text-xs text-rose-400" role="status">{{ errorSig() }}</p>
    }
  </section>
  <!-- TODO: Remove unnecessary Tailwind and use Primeng -->
  <p-drawer
    header="Profile"
    position="right"
    [visible]="sidebarVisible()"
    (visibleChange)="handleVisibilityChange($event)"
    [modal]="true"
    [dismissible]="true"
    [blockScroll]="true"
    [closeOnEscape]="true"
    styleClass="">
    <section class="flex flex-col items-center gap-3 sm:gap-4">
      <div class="profile-drawer__avatar-wrapper flex w-full justify-center">
        @if (avatarSrcSig()) {
          <p-avatar
            shape="circle"
            size="xlarge"
            styleClass="w-40 h-40 text-4xl font-semibold border-4 border-primary-600"
            [image]="avatarSrcSig()!"
            aria-label="User profile image"></p-avatar>
        } @else {
          <p-avatar
            shape="circle"
            size="xlarge"
            styleClass="w-40 h-40 text-4xl font-semibold border-4 border-primary-600"
            [label]="initialsSig()"
            aria-label="User profile initials"></p-avatar>
        }
      </div>

      <div class="flex flex-col items-center gap-0.5 text-center">
        <p class="profile-drawer__name text-xl font-semibold tracking-tight text-primary-600">
          {{ userSig()?.name }}
        </p>
        <p class="profile-drawer__username text-sm text-primary-200 flex items-center gap-1">
          <span class="text-primary-400" aria-hidden="true">@</span>
          <span class="profile-drawer__username-text text-primary-300">
            {{ userSig()?.username }}
          </span>
        </p>
      </div>

      @if (profileMetaSig()) {
        <div
          class="w-full rounded-2xl border border-slate-200/70 px-4 py-4 text-xs shadow-sm shadow-slate-200/60 ring-1 ring-white/70 backdrop-blur dark:border-slate-700/70  dark:shadow-slate-950/60 dark:ring-white/10">
          <p class="mb-3 text-[0.65rem] uppercase tracking-[0.2em] text-slate-500 dark:text-slate-400">
            Activity
          </p>

          <div class="flex flex-col divide-y divide-slate-200/60 dark:divide-slate-700/60">
            <div class="flex items-center justify-between gap-4 py-2 first:pt-0">
              <span class="text-[0.65rem] uppercase tracking-[0.12em] text-slate-500 dark:text-slate-400">Created</span>
              <span class="font-semibold text-slate-600 dark:text-slate-50">
                {{ profileMetaSig()?.createdAtLabel }}
              </span>
            </div>
            <div class="flex items-center justify-between gap-4 py-2">
              <span class="text-[0.65rem] uppercase tracking-[0.12em] text-slate-500 dark:text-slate-400">Updated</span>
              <span class="font-semibold text-slate-600 dark:text-slate-50">
                {{ profileMetaSig()?.updatedAtLabel || '-' }}
              </span>
            </div>
          </div>
        </div>
      }
    </section>
  </p-drawer>
